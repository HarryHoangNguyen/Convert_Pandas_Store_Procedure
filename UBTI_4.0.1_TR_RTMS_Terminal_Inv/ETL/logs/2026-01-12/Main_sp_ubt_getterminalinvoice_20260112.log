2026-01-12 09:30:55 - Main_sp_ubt_getterminalinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_4.0.1_TR_RTMS_Terminal_Inv/ETL/logs/2026-01-12/Main_sp_ubt_getterminalinvoice_20260112.log
2026-01-12 09:30:55 - Main_sp_ubt_getterminalinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_4.0.1_TR_RTMS_Terminal_Inv/ETL
2026-01-12 09:30:55 - Main_sp_ubt_getterminalinvoice - INFO - procdate set to: 2025-06-25 00:00:00
2026-01-12 09:30:56 - Main_sp_ubt_getterminalinvoice - INFO - Starting ETL process...
2026-01-12 09:30:56 - Main_sp_ubt_getterminalinvoice - INFO - procdate: 2025-06-25 00:00:00
2026-01-12 09:30:56 - Main_sp_ubt_getterminalinvoice - INFO - Processing UBT_TEMP_TERMINAL...
2026-01-12 09:30:57 - Main_sp_ubt_getterminalinvoice - INFO - UBT_TEMP_TERMINAL processed successfully. Rows: 1025
2026-01-12 09:30:57 - Main_sp_ubt_getterminalinvoice - INFO - Processing UBT_TEMP_PRODUCT...
2026-01-12 09:30:57 - Main_sp_ubt_getterminalinvoice - INFO - UBT_TEMP_PRODUCT processed successfully. Rows: 12
2026-01-12 09:30:57 - Main_sp_ubt_getterminalinvoice - INFO - Processing UBT_TEMP_LOCATION...
2026-01-12 09:30:57 - Main_sp_ubt_getterminalinvoice - INFO - UBT_TEMP_LOCATION processed successfully. Rows: 351
2026-01-12 09:30:57 - Main_sp_ubt_getterminalinvoice - INFO - Processing UBT_TEMP_TmpTicketByWageAndSales...
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - UBT_TEMP_TmpTicketByWageAndSales processed successfully. Rows: 77
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - Processing UBT_TEMP_ResultCashlessInTerminal...
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - UBT_TEMP_ResultCashlessInTerminal processed successfully. Rows: 0
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - Processing ubt_temp_iTOTO...
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - ubt_temp_iTOTO processed successfully. Rows: 0
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - Processing UBT_TEMP_GROUPTOTO...
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - UBT_TEMP_GROUPTOTO processed successfully. Rows: 0
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - Processing ubt_temp_CancelledBetTicketState...
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - ubt_temp_CancelledBetTicketState processed successfully. Rows: 4
2026-01-12 09:31:04 - Main_sp_ubt_getterminalinvoice - INFO - Processing ubt_temp_SalesGroupToto...
2026-01-12 09:31:05 - Main_sp_ubt_getterminalinvoice - INFO - ubt_temp_SalesGroupToto processed successfully. Rows: 0
2026-01-12 09:31:05 - Main_sp_ubt_getterminalinvoice - INFO - Processing ubt_temp_salestoto...
2026-01-12 09:31:05 - Main_sp_ubt_getterminalinvoice - INFO - ubt_temp_salestoto processed successfully. Rows: 0
2026-01-12 09:31:05 - Main_sp_ubt_getterminalinvoice - INFO - Processing ubt_temp_transamountdetaildata...
2026-01-12 09:31:05 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20250625, to=20250625
2026-01-12 09:31:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-12 09:31:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-12 09:31:07 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-12 09:31:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-12 09:31:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-12 09:31:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-12 09:31:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-12 09:31:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-12 09:31:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-12 09:31:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-12 09:31:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-12 09:31:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-12 09:31:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-12 09:31:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-12 09:31:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-12 09:31:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-12 09:31:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=2
2026-01-12 09:31:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=1025
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-12 09:31:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-12 09:31:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-12 09:31:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-12 09:31:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-12 09:31:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-12 09:31:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-12 09:31:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-12 09:31:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-12 09:31:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-12 09:31:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=62465
2026-01-12 09:31:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=62465
2026-01-12 09:31:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=62465
2026-01-12 09:31:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=62465
2026-01-12 09:31:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=62465
2026-01-12 09:31:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 34.24 seconds and fetched: rows=56406
2026-01-12 09:31:19 - Main_sp_ubt_getterminalinvoice - INFO - ubt_temp_transamountdetaildata processed successfully. Rows: 55263
2026-01-12 09:31:20 - Main_sp_ubt_getterminalinvoice - INFO - Processing ubt_temp_sales_scandsr...
2026-01-12 09:31:23 - Main_sp_ubt_getterminalinvoice - INFO - ubt_temp_sales_scandsr processed successfully. Rows: 0
2026-01-12 09:31:23 - Main_sp_ubt_getterminalinvoice - INFO - Processing ubt_temp_salesfactorconfig...
2026-01-12 09:31:23 - Main_sp_ubt_getterminalinvoice - INFO - ubt_temp_salesfactorconfig processed successfully. Rows: 8
2026-01-12 09:31:23 - Main_sp_ubt_getterminalinvoice - INFO - Processing ubt_temp_tmpterlocprdsalesamt...
2026-01-12 09:31:29 - Main_sp_ubt_getterminalinvoice - INFO - ubt_temp_tmpterlocprdsalesamt processed successfully. Rows: 18453
2026-01-12 09:31:29 - Main_sp_ubt_getterminalinvoice - INFO - ETL process completed in 34.26 seconds.
