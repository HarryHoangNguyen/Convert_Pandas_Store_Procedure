2026-01-12 10:12:49,117 [CRITICAL] [ETL:SP_UBT_GETRTSHOPCLOUD] Uncaught exception occurred
Traceback (most recent call last):
  File "/home/minhhoang/pyspark/Python-Project/UBTI_3.0.2_TR_RTMS_SAPFIN_SHOP/ETL/Main_sp_ubt_getrtshopcloud.py", line 26, in <module>
    connection = snowflake_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhhoang/pyspark/Python-Project/UBTI_3.0.2_TR_RTMS_SAPFIN_SHOP/ETL/Snowflake_connection.py", line 22, in snowflake_connection
    conn = snowflake.connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/connection.py", line 654, in __init__
    self.connect(**kwargs)
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1120, in connect
    self.__open_connection()
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1536, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1870, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1902, in _authenticate
    auth.authenticate(
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/auth/_auth.py", line 181, in authenticate
    body_template = Auth.base_auth_data(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/auth/_auth.py", line 132, in base_auth_data
    "PLATFORM": detect_platforms(
                ^^^^^^^^^^^^^^^^^
  File "/home/minhhoang/pyspark/.venv/lib/python3.12/site-packages/snowflake/connector/platform_detection.py", line 455, in detect_platforms
    {key: future.result() for key, future in futures.items()}
          ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 451, in result
    self._condition.wait(timeout)
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt
2026-01-12 10:12:59,588 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Starting Stored Pocedure: SP_UBT_GETRTSHOPCLOUD
2026-01-12 10:12:59,589 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Runtime procdate: 20251229
2026-01-12 10:12:59,589 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Loading GST Config...
2026-01-12 10:12:59,750 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] No GST Rate found for the given procdate. Defaulting to 0.
2026-01-12 10:12:59,751 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Determining vInputTax values based on procdate...
2026-01-12 10:12:59,756 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] vInputTax determined: P3
2026-01-12 10:13:00,929 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] ztubt_terminal rows=1025
2026-01-12 10:13:01,068 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] ztubt_terminal rows=1025
2026-01-12 10:13:01,069 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Calling SP_UBT_GETTRANSAMOUNTDETAILS ...
2026-01-12 10:13:01,069 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251229, to=20251229
2026-01-12 10:13:04,598 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-12 10:13:04,598 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Initializing SP_UBT_GETCOMMONUBTDATES with input range from=20251229, to=20251229
2026-01-12 10:13:07,244 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Retrieving BMCS/IGT/OB host ...
2026-01-12 10:13:07,245 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for BMCS, date=2025-12-28 00:00:00
2026-01-12 10:13:08,885 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for BMCS on 2025-12-28 00:00:00
2026-01-12 10:13:08,885 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for BMCS, date=2025-12-29 00:00:00
2026-01-12 10:13:09,657 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for BMCS on 2025-12-29 00:00:00
2026-01-12 10:13:09,658 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for IGT, date=2025-12-28 00:00:00
2026-01-12 10:13:10,115 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for IGT on 2025-12-28 00:00:00
2026-01-12 10:13:10,116 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for IGT, date=2025-12-29 00:00:00
2026-01-12 10:13:11,145 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for IGT on 2025-12-29 00:00:00
2026-01-12 10:13:11,145 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for OB, date=2025-12-28 00:00:00
2026-01-12 10:13:11,821 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for OB on 2025-12-28 00:00:00
2026-01-12 10:13:11,821 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for OB, date=2025-12-29 00:00:00
2026-01-12 10:13:12,141 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for OB on 2025-12-29 00:00:00
2026-01-12 10:13:12,141 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Retrieving NonHost window...
2026-01-12 10:13:12,973 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] NonHost: from NaT to NaT
2026-01-12 10:13:12,973 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Fund: from 2026-01-02 00:00:00 to 2025-12-23 00:00:00
2026-01-12 10:13:13,059 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] completed successfully in 16.99 seconds and fetched: rows=1
2026-01-12 10:13:16,490 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-12 10:13:16,938 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-12 10:13:17,031 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-12 10:13:17,501 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-12 10:13:17,730 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-12 10:13:17,841 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-12 10:13:17,951 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-12 10:13:18,058 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-12 10:13:18,249 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-12 10:13:18,375 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-12 10:13:18,479 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-12 10:13:18,572 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-12 10:13:18,697 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-12 10:13:19,710 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-12 10:13:19,971 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-12 10:13:20,077 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=1025
2026-01-12 10:13:20,208 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-12 10:13:20,383 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-12 10:13:20,494 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-12 10:13:20,534 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-12 10:13:20,580 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-12 10:13:20,640 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-12 10:13:20,686 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-12 10:13:20,734 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-12 10:13:20,781 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-12 10:13:21,122 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-12 10:13:21,327 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-12 10:13:21,442 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-12 10:13:21,571 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-12 10:13:21,749 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-12 10:13:21,927 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-12 10:13:22,059 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-12 10:13:22,133 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-12 10:13:22,452 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:23,068 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:23,197 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:23,283 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:23,364 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:23,518 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] completed successfully in 27.45 seconds and fetched: rows=56405
2026-01-12 10:13:23,573 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] sp_ubt_gettransamountdetails Columns names ['TERDISPLAYID', 'PRODNAME', 'FLAG', 'AMOUNT', 'TICKETCOUNT', 'ACTUALDATE', 'LOCTYPEID', 'TRANSTYPE'], rows=55261
2026-01-12 10:13:23,573 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] sp_ubt_gettransamountdetails returned 55261 records for procdate = 20251229.
2026-01-12 10:13:23,732 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Processing PayNow & PayNowQR...
2026-01-12 10:13:23,770 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] Total PayNow records: rows=0
2026-01-12 10:13:23,848 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Filtering TerminalTempData...
2026-01-12 10:13:23,896 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] TerminalTempData rows=10240
2026-01-12 10:13:23,896 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Enriching transaction data with terminal & location info...
2026-01-12 10:13:23,914 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Enriched dataset size: rows=10180
2026-01-12 10:13:23,992 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [PayNow_and_PaynowQR] TB_RTMS_RTShopCloud generated successfully, rows=0
2026-01-12 10:13:23,993 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] PeriodStartDate determined based on vnowDayName: 20251227
2026-01-12 10:13:23,993 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251227, to=20251229
2026-01-12 10:13:27,145 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-12 10:13:27,146 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Initializing SP_UBT_GETCOMMONUBTDATES with input range from=20251227, to=20251229
2026-01-12 10:13:29,562 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Retrieving BMCS/IGT/OB host ...
2026-01-12 10:13:29,562 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for BMCS, date=2025-12-26 00:00:00
2026-01-12 10:13:30,164 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for BMCS on 2025-12-26 00:00:00
2026-01-12 10:13:30,165 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for BMCS, date=2025-12-29 00:00:00
2026-01-12 10:13:30,541 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for BMCS on 2025-12-29 00:00:00
2026-01-12 10:13:30,541 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for IGT, date=2025-12-26 00:00:00
2026-01-12 10:13:31,177 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for IGT on 2025-12-26 00:00:00
2026-01-12 10:13:31,178 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for IGT, date=2025-12-29 00:00:00
2026-01-12 10:13:31,507 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for IGT on 2025-12-29 00:00:00
2026-01-12 10:13:31,508 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for OB, date=2025-12-26 00:00:00
2026-01-12 10:13:31,834 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for OB on 2025-12-26 00:00:00
2026-01-12 10:13:31,834 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for OB, date=2025-12-29 00:00:00
2026-01-12 10:13:32,163 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for OB on 2025-12-29 00:00:00
2026-01-12 10:13:32,163 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Retrieving NonHost window...
2026-01-12 10:13:32,394 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] NonHost: from NaT to NaT
2026-01-12 10:13:32,394 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Fund: from None to None
2026-01-12 10:13:32,470 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] completed successfully in 36.40 seconds and fetched: rows=1
2026-01-12 10:13:35,702 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-12 10:13:35,999 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-12 10:13:36,090 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-12 10:13:36,221 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-12 10:13:36,307 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-12 10:13:36,457 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-12 10:13:36,582 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-12 10:13:37,162 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-12 10:13:37,296 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-12 10:13:37,383 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-12 10:13:37,466 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-12 10:13:37,577 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-12 10:13:37,667 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-12 10:13:37,815 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-12 10:13:38,066 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-12 10:13:38,179 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=1025
2026-01-12 10:13:38,295 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-12 10:13:38,429 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-12 10:13:38,589 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-12 10:13:38,632 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-12 10:13:38,673 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-12 10:13:38,728 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-12 10:13:38,771 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-12 10:13:38,816 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-12 10:13:38,863 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-12 10:13:38,992 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-12 10:13:39,111 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-12 10:13:39,231 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-12 10:13:39,345 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-12 10:13:39,521 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-12 10:13:39,642 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-12 10:13:39,773 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-12 10:13:39,847 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-12 10:13:40,079 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:40,728 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:40,842 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:40,927 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:41,006 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=62464
2026-01-12 10:13:41,158 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETTRANSAMOUNTDETAILS] completed successfully in 45.09 seconds and fetched: rows=56405
2026-01-12 10:13:41,372 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] sp_ubt_gettransamountdetails for SecondDate Columns names ['TERDISPLAYID', 'PRODUCTNAME', 'AMOUNT', 'TICKETCOUNT', 'FLAG', 'TRANSTYPE', 'FROMDATE', 'TODATE'], rows=55261
2026-01-12 10:13:48,474 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Initializing SP_UBT_GETCOMMONUBTDATES with input range from=2025-12-29 00:00:00, to=2025-12-29 00:00:00
2026-01-12 10:13:50,850 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Retrieving BMCS/IGT/OB host ...
2026-01-12 10:13:50,851 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for BMCS, date=2025-12-28 00:00:00
2026-01-12 10:13:51,529 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for BMCS on 2025-12-28 00:00:00
2026-01-12 10:13:51,530 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for BMCS, date=2025-12-29 00:00:00
2026-01-12 10:13:51,957 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for BMCS on 2025-12-29 00:00:00
2026-01-12 10:13:51,957 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for IGT, date=2025-12-28 00:00:00
2026-01-12 10:13:53,133 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for IGT on 2025-12-28 00:00:00
2026-01-12 10:13:53,133 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for IGT, date=2025-12-29 00:00:00
2026-01-12 10:13:53,484 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for IGT on 2025-12-29 00:00:00
2026-01-12 10:13:53,485 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for OB, date=2025-12-28 00:00:00
2026-01-12 10:13:53,825 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for OB on 2025-12-28 00:00:00
2026-01-12 10:13:53,825 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Querying perioddatetime for OB, date=2025-12-29 00:00:00
2026-01-12 10:13:54,155 [WARNING] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] No perioddatetime found for OB on 2025-12-29 00:00:00
2026-01-12 10:13:54,155 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Retrieving NonHost window...
2026-01-12 10:13:54,391 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] NonHost: from NaT to NaT
2026-01-12 10:13:54,392 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] Fund: from 2026-01-02 00:00:00 to 2025-12-23 00:00:00
2026-01-12 10:13:54,480 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [SP_GETCOMMONUBTDATES] completed successfully in 58.41 seconds and fetched: rows=1
2026-01-12 10:13:57,145 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] sp_ubt_getamounttransaction rows=0, columns=['TICKETSERIALNUMBER', 'WAGER', 'SECONDWAGER', 'SALES', 'SECONDSALES', 'SALESCOMM', 'SECONDSALESCOMM', 'GST', 'SECONDGST', 'RETURNAMOUNT', 'WINNINGAMOUNT']
2026-01-12 10:13:57,274 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [sp_ubt_getrtshopcloud_sport] df_ubt_tmp_V2_LocationTempData created with shape: rows=5852
2026-01-12 10:13:57,296 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [sp_ubt_getrtshopcloud_sport] df_ubt_tmp_V2_TSNWagerSalesAmountData created with shape: rows=0
2026-01-12 10:13:57,315 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [sp_ubt_getrtshopcloud_sport]✅ df_temp for Branch Normal calculation created with shape: rows=515
2026-01-12 10:13:57,315 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] [sp_ubt_getrtshopcloud_sport]✅ vTotalAmount for Branch Normal calculation: 0.0
2026-01-12 10:13:57,519 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] sp_ubt_getrtshopcloud_sport rows=0
2026-01-12 10:13:57,519 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [sp_ubt_getrtshopcloud_sport] TB_RTMS_RTShopCloud updated successfully, rows=0
2026-01-12 10:14:01,005 [DEBUG] [ETL:SP_UBT_GETRTSHOPCLOUD] sp_ubt_getrtshopcloud_hr rows=0
2026-01-12 10:14:01,006 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] [sp_ubt_getrtshopcloud_hr] TB_RTMS_RTShopCloud updated successfully, rows=0
2026-01-12 10:14:01,011 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Converting data types to match Snowflake schema...
2026-01-12 10:14:01,018 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Final dataset rows=0.
2026-01-12 10:14:06,460 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] Insert final data into Snowflake completed successfully
2026-01-12 10:14:06,460 [INFO] [ETL:SP_UBT_GETRTSHOPCLOUD] SP_UBT_GETRTSHOPCLOUD completed successfully in 70.39 seconds
