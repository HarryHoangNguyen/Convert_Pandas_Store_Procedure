2026-01-09 12:53:07 - Main_sp_ubt_gettransactiondataforinterval - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_1.0.2_TR_RTMS_Bet_Transactions/ETL/logs/Main_sp_ubt_gettransactiondataforinterval_20260109.log
2026-01-09 12:53:07 - Main_sp_ubt_gettransactiondataforinterval - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_1.0.2_TR_RTMS_Bet_Transactions/ETL
2026-01-09 12:53:07 - Main_sp_ubt_gettransactiondataforinterval - INFO - Running in LOCAL mode. startdatetime: 2025-09-23 06:00:00, enddatetime: 2025-09-24 06:00:00
2026-01-09 12:53:07 - Main_sp_ubt_gettransactiondataforinterval - INFO - Start DateTime: 2025-09-23 06:00:00, End DateTime: 2025-09-24 06:00:00
2026-01-09 12:53:08 - Main_sp_ubt_gettransactiondataforinterval - INFO - startdate: 2025-09-23 06:00:00, enddate: 2025-09-24 06:00:00, startdateUTC: 2025-09-22 22:00:00, enddateUTC: 2025-09-23 22:00:00
2026-01-09 12:53:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 12:53:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 12:53:14 - Transformation - INFO - UBT_TEMP_PLACEBETTRANSACTION rows: 308
2026-01-09 12:53:14 - Transformation - INFO - UBT_TEMP_PLACEBETTRANSACTIONTYPE rows: 293
2026-01-09 12:53:14 - Transformation - INFO - Processing UBT_TEMP_BETTYPE
2026-01-09 12:53:15 - Transformation - INFO - UBT_TEMP_BETTYPE rows: 1011
2026-01-09 12:53:15 - Transformation - INFO - Processing UBT_TEMP_HORSEDETAIL
2026-01-09 12:53:16 - Transformation - INFO - UBT_TEMP_HORSEDETAIL rows: 0
2026-01-09 12:53:16 - Transformation - INFO - Processing UBT_TEMP_NUMBOARD
2026-01-09 12:53:16 - Transformation - INFO - UBT_TEMP_NUMBOARD rows: 293
2026-01-09 12:53:16 - Transformation - INFO - Processing UBT_TEMP_LOTTERYDRAW
2026-01-09 12:53:16 - Transformation - INFO - UBT_TEMP_LOTTERYDRAW rows: 0
2026-01-09 12:53:16 - Transformation - INFO - Processing UBT_TEMP_NUMDRAW
2026-01-09 12:53:16 - Transformation - INFO - UBT_TEMP_NUMDRAW rows: 0
2026-01-09 12:53:16 - Transformation - INFO - Processing UBT_TEMP_TOTOSEQ
2026-01-09 12:53:16 - Transformation - INFO - UBT_TEMP_TOTOSEQ rows: 1007
2026-01-09 12:53:16 - Transformation - INFO - Processing UBT_TEMP_TOTOGROUP
2026-01-09 12:53:16 - Transformation - INFO - UBT_TEMP_TOTOGROUP rows: 0
2026-01-09 12:53:16 - Transformation - INFO - Processing UBT_TEMP_LOTTERYDETAILS
2026-01-09 12:53:16 - Transformation - INFO - UBT_TEMP_LOTTERYDETAILS rows: 0
2026-01-09 12:53:16 - Transformation - INFO - Processing UBT_TEMP_LIVEINDICATOR
2026-01-09 12:53:19 - Transformation - INFO - UBT_TEMP_LIVEINDICATOR rows: 0
2026-01-09 12:53:19 - Transformation - INFO - Processing UBT_TEMP_SPORT_DETAILS
2026-01-09 12:53:20 - Transformation - INFO - UBT_TEMP_SPORT_DETAILS rows: 0
2026-01-09 12:53:20 - Transformation - INFO - Processing UBT_TEMP_TRANS
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.1 - Line 918 - 934 with 290 rows
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.2 - Line 947 - 967 with 0 rows
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.3 (Line 973- 1017) with 0 rows
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.4 (Line 1025 - 1044) with 0 rows
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.5 (Line 1049-1068) with 0 rows
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.6 (Line 1071 - 1090) with 15 rows
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.7 (Line 1095 - 1115) with 0 rows
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_TRANS rows: 305
2026-01-09 12:53:21 - Transformation - INFO - Processing UBT_TEMP_RESULTWAGER
2026-01-09 12:53:21 - Transformation - INFO - UBT_TEMP_RESULTWAGER rows: 1007
2026-01-09 12:53:21 - Transformation - INFO - Processing UBT_TEMP_RESULTSALESCOMWITHDATE
2026-01-09 12:53:22 - Transformation - INFO - UBT_TEMP_RESULTSALESCOMWITHDATE rows: 1007
2026-01-09 12:53:22 - Transformation - INFO - Processing UBT_TEMP_RESULTSALESSANDCOMM
2026-01-09 12:53:23 - Transformation - INFO - UBT_TEMP_RESULTSALESSANDCOMM rows: 1007
2026-01-09 12:53:23 - Transformation - INFO - Processing UBT_TEMP_RESULTGST
2026-01-09 12:53:23 - Transformation - INFO - UBT_TEMP_RESULTGST rows: 1007
2026-01-09 12:53:23 - Transformation - INFO - Processing UBT_TEMP_RESULTVALIDATION
2026-01-09 12:53:23 - Transformation - INFO - UBT_TEMP_RESULTVALIDATION rows: 13
2026-01-09 12:53:23 - Transformation - INFO - Processing UBT_TEMP_RESULTVALIDATIONEXCHANGE
2026-01-09 12:53:24 - Transformation - INFO - UBT_TEMP_RESULTVALIDATIONEXCHANGE rows: 0
2026-01-09 12:53:24 - Transformation - INFO - Processing UBT_TEMP_TRANSACTIONAMOUNT
2026-01-09 12:53:24 - Transformation - INFO - UBT_TEMP_TRANSACTIONAMOUNT rows: 1007
2026-01-09 12:53:24 - Transformation - INFO - Processing UBT_TEMP_FINAL_LOTTERYSELECT
2026-01-09 12:53:24 - Transformation - INFO - UBT_TEMP_FINAL_LOTTERYSELECT rows: 1011
2026-01-09 12:53:24 - Transformation - INFO - Processing UBT_TEMP_TRANSACTIONDATA
2026-01-09 12:53:25 - Transformation - INFO - UBT_TEMP_TRANSACTIONDATA rows: 1031
2026-01-09 12:53:25 - Transformation - INFO - Writing UBT_TEMP_TRANSACTIONDATA to Snowflake
2026-01-09 12:53:25 - write_pandas - INFO - Current context - Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC, Warehouse: SPPL_WH_DEV
2026-01-09 12:53:25 - write_pandas - INFO - Switched to Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC
2026-01-09 12:53:26 - write_pandas - INFO - Table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETTRANSACTIONDATAFORINTERVAL exists. Clearing existing data...
2026-01-09 12:53:26 - write_pandas - INFO - Successfully deleted records for PROCDATE = '2025-09-23'
2026-01-09 12:53:26 - write_pandas - INFO - Inserting new data into existing table...
2026-01-09 12:53:27 - write_pandas - INFO - Verification: 1832 rows found in SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETTRANSACTIONDATAFORINTERVAL
2026-01-09 12:53:28 - write_pandas - INFO - Successfully written 1031 rows to SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETTRANSACTIONDATAFORINTERVAL
2026-01-09 12:53:28 - write_pandas - INFO - Number of chunks: 1, Success: True
2026-01-09 12:55:19 - Main_sp_ubt_gettransactiondataforinterval - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_1.0.2_TR_RTMS_Bet_Transactions/ETL/logs/Main_sp_ubt_gettransactiondataforinterval_20260109.log
2026-01-09 12:55:19 - Main_sp_ubt_gettransactiondataforinterval - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_1.0.2_TR_RTMS_Bet_Transactions/ETL
2026-01-09 12:55:19 - Main_sp_ubt_gettransactiondataforinterval - INFO - Running in LOCAL mode. startdatetime: 2025-09-23 06:00:00, enddatetime: 2025-09-24 06:00:00
2026-01-09 12:55:19 - Main_sp_ubt_gettransactiondataforinterval - INFO - Start DateTime: 2025-09-23 06:00:00, End DateTime: 2025-09-24 06:00:00
2026-01-09 12:55:20 - Main_sp_ubt_gettransactiondataforinterval - INFO - startdate: 2025-09-23 06:00:00, enddate: 2025-09-24 06:00:00, startdateUTC: 2025-09-22 22:00:00, enddateUTC: 2025-09-23 22:00:00
2026-01-09 12:55:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 12:55:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 12:55:26 - Transformation - INFO - UBT_TEMP_PLACEBETTRANSACTION rows: 308
2026-01-09 12:55:26 - Transformation - INFO - UBT_TEMP_PLACEBETTRANSACTIONTYPE rows: 293
2026-01-09 12:55:26 - Transformation - INFO - Processing UBT_TEMP_BETTYPE
2026-01-09 12:55:27 - Transformation - INFO - UBT_TEMP_BETTYPE rows: 1011
2026-01-09 12:55:27 - Transformation - INFO - Processing UBT_TEMP_HORSEDETAIL
2026-01-09 12:55:28 - Transformation - INFO - UBT_TEMP_HORSEDETAIL rows: 0
2026-01-09 12:55:28 - Transformation - INFO - Processing UBT_TEMP_NUMBOARD
2026-01-09 12:55:28 - Transformation - INFO - UBT_TEMP_NUMBOARD rows: 293
2026-01-09 12:55:28 - Transformation - INFO - Processing UBT_TEMP_LOTTERYDRAW
2026-01-09 12:55:28 - Transformation - INFO - UBT_TEMP_LOTTERYDRAW rows: 0
2026-01-09 12:55:28 - Transformation - INFO - Processing UBT_TEMP_NUMDRAW
2026-01-09 12:55:28 - Transformation - INFO - UBT_TEMP_NUMDRAW rows: 0
2026-01-09 12:55:28 - Transformation - INFO - Processing UBT_TEMP_TOTOSEQ
2026-01-09 12:55:28 - Transformation - INFO - UBT_TEMP_TOTOSEQ rows: 1007
2026-01-09 12:55:28 - Transformation - INFO - Processing UBT_TEMP_TOTOGROUP
2026-01-09 12:55:28 - Transformation - INFO - UBT_TEMP_TOTOGROUP rows: 0
2026-01-09 12:55:28 - Transformation - INFO - Processing UBT_TEMP_LOTTERYDETAILS
2026-01-09 12:55:28 - Transformation - INFO - UBT_TEMP_LOTTERYDETAILS rows: 0
2026-01-09 12:55:28 - Transformation - INFO - Processing UBT_TEMP_LIVEINDICATOR
2026-01-09 12:55:29 - Transformation - INFO - UBT_TEMP_LIVEINDICATOR rows: 0
2026-01-09 12:55:29 - Transformation - INFO - Processing UBT_TEMP_SPORT_DETAILS
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_SPORT_DETAILS rows: 0
2026-01-09 12:55:30 - Transformation - INFO - Processing UBT_TEMP_TRANS
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.1 - Line 918 - 934 with 290 rows
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.2 - Line 947 - 967 with 0 rows
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.3 (Line 973- 1017) with 0 rows
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.4 (Line 1025 - 1044) with 0 rows
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.5 (Line 1049-1068) with 0 rows
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.6 (Line 1071 - 1090) with 15 rows
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_TRANS : COMPLETED 1.7 (Line 1095 - 1115) with 0 rows
2026-01-09 12:55:30 - Transformation - INFO - UBT_TEMP_TRANS rows: 305
2026-01-09 12:55:30 - Transformation - INFO - Processing UBT_TEMP_RESULTWAGER
2026-01-09 12:55:31 - Transformation - INFO - UBT_TEMP_RESULTWAGER rows: 1007
2026-01-09 12:55:31 - Transformation - INFO - Processing UBT_TEMP_RESULTSALESCOMWITHDATE
2026-01-09 12:55:32 - Transformation - INFO - UBT_TEMP_RESULTSALESCOMWITHDATE rows: 1007
2026-01-09 12:55:32 - Transformation - INFO - Processing UBT_TEMP_RESULTSALESSANDCOMM
2026-01-09 12:55:32 - Transformation - INFO - UBT_TEMP_RESULTSALESSANDCOMM rows: 1007
2026-01-09 12:55:32 - Transformation - INFO - Processing UBT_TEMP_RESULTGST
2026-01-09 12:55:32 - Transformation - INFO - UBT_TEMP_RESULTGST rows: 1007
2026-01-09 12:55:32 - Transformation - INFO - Processing UBT_TEMP_RESULTVALIDATION
2026-01-09 12:55:33 - Transformation - INFO - UBT_TEMP_RESULTVALIDATION rows: 13
2026-01-09 12:55:33 - Transformation - INFO - Processing UBT_TEMP_RESULTVALIDATIONEXCHANGE
2026-01-09 12:55:33 - Transformation - INFO - UBT_TEMP_RESULTVALIDATIONEXCHANGE rows: 0
2026-01-09 12:55:33 - Transformation - INFO - Processing UBT_TEMP_TRANSACTIONAMOUNT
2026-01-09 12:55:33 - Transformation - INFO - UBT_TEMP_TRANSACTIONAMOUNT rows: 1007
2026-01-09 12:55:33 - Transformation - INFO - Processing UBT_TEMP_FINAL_LOTTERYSELECT
2026-01-09 12:55:34 - Transformation - INFO - UBT_TEMP_FINAL_LOTTERYSELECT rows: 1011
2026-01-09 12:55:34 - Transformation - INFO - Processing UBT_TEMP_TRANSACTIONDATA
2026-01-09 12:55:34 - Transformation - INFO - UBT_TEMP_TRANSACTIONDATA rows: 1031
2026-01-09 12:55:34 - Transformation - INFO - Writing UBT_TEMP_TRANSACTIONDATA to Snowflake
2026-01-09 12:55:34 - write_pandas - INFO - Current context - Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC, Warehouse: SPPL_WH_DEV
2026-01-09 12:55:34 - write_pandas - INFO - Switched to Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC
2026-01-09 12:55:35 - write_pandas - INFO - Table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETTRANSACTIONDATAFORINTERVAL exists. Clearing existing data...
2026-01-09 12:55:35 - write_pandas - INFO - Successfully deleted records for PROCDATE = '2025-09-23'
2026-01-09 12:55:35 - write_pandas - INFO - Inserting new data into existing table...
2026-01-09 12:55:40 - write_pandas - INFO - Verification: 1832 rows found in SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETTRANSACTIONDATAFORINTERVAL
2026-01-09 12:55:40 - write_pandas - INFO - Successfully written 1031 rows to SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETTRANSACTIONDATAFORINTERVAL
2026-01-09 12:55:40 - write_pandas - INFO - Number of chunks: 1, Success: True
