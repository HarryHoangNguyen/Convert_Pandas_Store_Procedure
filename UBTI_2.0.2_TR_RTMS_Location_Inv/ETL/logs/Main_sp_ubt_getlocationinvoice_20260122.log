2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260122.log
2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 20251127
2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 20251127
2026-01-22 14:28:02 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-22 14:28:02 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-22 14:28:02 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-22 14:28:02 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-22 14:28:02 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-22 14:28:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-22 14:28:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-22 14:28:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-22 14:28:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-22 14:28:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-22 14:28:03 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 1 records.
2026-01-22 14:28:03 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 1
2026-01-22 14:28:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-22 14:28:06 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 13
2026-01-22 14:28:06 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-22 14:28:06 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-22 14:28:06 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-22 14:28:07 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 19
2026-01-22 14:28:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-22 14:28:07 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-22 14:28:07 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-22 14:28:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-22 14:28:07 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-22 14:28:07 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-22 14:28:07 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-22 14:28:07 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-22 14:28:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-22 14:28:07 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-22 14:28:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-22 14:28:07 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-22 14:28:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-22 14:28:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-22 14:28:09 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-22 14:28:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-22 14:28:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:28:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:28:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-22 14:28:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-22 14:28:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-22 14:28:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-22 14:28:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-22 14:28:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-22 14:28:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-22 14:28:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-22 14:28:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-22 14:28:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-22 14:28:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-22 14:28:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-22 14:28:16 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:28:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:28:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:28:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:28:17 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:28:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 29.04 seconds and fetched: rows=61540
2026-01-22 14:28:18 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-22 14:28:18 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-22 14:28:19 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-22 14:28:20 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-22 14:28:20 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-22 14:28:20 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-22 14:32:01 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260122.log
2026-01-22 14:32:01 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-22 14:32:01 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 20251127
2026-01-22 14:32:01 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 20251127
2026-01-22 14:32:01 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-22 14:32:01 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-22 14:32:01 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-22 14:32:02 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-22 14:32:02 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-22 14:32:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-22 14:32:03 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 1 records.
2026-01-22 14:32:03 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 1
2026-01-22 14:32:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 13
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 19
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-22 14:32:11 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-22 14:32:11 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-22 14:32:11 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-22 14:32:11 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-22 14:32:11 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-22 14:32:11 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-22 14:32:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-22 14:32:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-22 14:32:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-22 14:32:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-22 14:32:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-22 14:32:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:32:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:32:18 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-22 14:32:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-22 14:32:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-22 14:32:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-22 14:32:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-22 14:32:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:32:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:32:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-22 14:32:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-22 14:32:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-22 14:32:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-22 14:32:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-22 14:32:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-22 14:32:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-22 14:32:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-22 14:32:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-22 14:32:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-22 14:32:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-22 14:32:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-22 14:32:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-22 14:32:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-22 14:32:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:32:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:32:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:32:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:32:24 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:32:24 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 31.83 seconds and fetched: rows=61540
2026-01-22 14:32:24 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-22 14:32:24 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-22 14:32:25 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-22 14:32:25 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-22 14:32:25 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-22 14:32:25 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-22 14:32:25 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-22 14:32:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-22 14:33:39 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260122.log
2026-01-22 14:33:39 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-22 14:33:39 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 20251127
2026-01-22 14:33:39 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 20251127
2026-01-22 14:33:39 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-22 14:33:39 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-22 14:33:39 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-22 14:33:40 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-22 14:33:40 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-22 14:33:40 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-22 14:33:40 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-22 14:33:40 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-22 14:33:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-22 14:33:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-22 14:33:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-22 14:33:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-22 14:33:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-22 14:33:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-22 14:33:41 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 1 records.
2026-01-22 14:33:41 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 1
2026-01-22 14:33:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 13
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 19
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-22 14:33:45 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-22 14:33:45 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-22 14:33:45 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-22 14:33:45 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-22 14:33:45 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-22 14:33:45 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-22 14:33:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-22 14:33:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-22 14:33:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-22 14:33:53 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-22 14:33:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-22 14:33:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:33:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:33:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-22 14:33:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-22 14:33:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-22 14:33:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-22 14:33:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-22 14:33:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:33:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:33:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-22 14:33:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-22 14:33:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:33:56 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-22 14:33:57 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-22 14:33:57 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-22 14:33:57 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-22 14:33:57 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-22 14:33:57 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-22 14:33:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-22 14:33:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-22 14:33:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-22 14:33:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:33:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:33:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:33:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:33:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:33:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 30.35 seconds and fetched: rows=61540
2026-01-22 14:33:59 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-22 14:33:59 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-22 14:34:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-22 14:34:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-22 14:34:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-22 14:34:01 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-22 14:41:06 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260122.log
2026-01-22 14:41:06 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-22 14:41:06 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 20251127
2026-01-22 14:41:06 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 20251127
2026-01-22 14:41:06 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-22 14:41:06 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-22 14:41:06 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-22 14:41:06 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-22 14:41:06 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-22 14:41:06 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-22 14:41:07 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 1 records.
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 1
2026-01-22 14:41:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 13
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 19
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-22 14:41:12 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-22 14:41:12 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-22 14:41:12 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-22 14:41:12 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-22 14:41:12 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-22 14:41:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-22 14:41:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-22 14:41:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-22 14:41:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-22 14:41:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-22 14:41:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-22 14:41:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:41:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:41:19 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-22 14:41:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-22 14:41:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-22 14:41:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-22 14:41:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-22 14:41:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:41:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:41:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-22 14:41:20 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-22 14:41:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-22 14:41:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-22 14:41:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-22 14:41:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-22 14:41:21 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-22 14:41:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-22 14:41:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-22 14:41:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-22 14:41:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:41:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-22 14:41:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:41:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-22 14:41:22 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-22 14:41:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-22 14:41:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-22 14:41:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-22 14:41:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-22 14:41:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-22 14:41:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-22 14:41:24 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-22 14:41:24 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:41:25 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:41:25 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:41:25 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:41:25 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:41:25 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 32.48 seconds and fetched: rows=61540
2026-01-22 14:41:25 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-22 14:41:25 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-22 14:41:26 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-22 14:41:27 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-22 14:41:28 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-22 14:41:28 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-22 14:41:28 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-22 14:41:28 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-22 14:41:28 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-22 14:41:28 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-22 14:41:28 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-22 14:42:23 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260122.log
2026-01-22 14:42:23 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-22 14:42:23 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 20251127
2026-01-22 14:42:23 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 20251127
2026-01-22 14:42:23 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-22 14:42:23 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-22 14:42:23 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-22 14:42:24 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-22 14:42:24 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-22 14:42:24 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-22 14:42:24 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-22 14:42:24 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-22 14:42:24 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-22 14:42:24 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-22 14:42:24 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-22 14:42:24 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-22 14:42:25 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-22 14:42:25 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-22 14:42:25 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 1 records.
2026-01-22 14:42:25 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 1
2026-01-22 14:42:25 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 13
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 19
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-22 14:42:29 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-22 14:42:29 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-22 14:42:29 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-22 14:42:29 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-22 14:42:29 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-22 14:42:29 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-22 14:42:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-22 14:42:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-22 14:42:32 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-22 14:42:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-22 14:42:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:42:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-22 14:42:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-22 14:42:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-22 14:42:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-22 14:42:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-22 14:42:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-22 14:42:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-22 14:42:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-22 14:42:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-22 14:42:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-22 14:42:42 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-22 14:42:42 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-22 14:42:42 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-22 14:42:43 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:42:43 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:42:43 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:42:43 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:42:44 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-22 14:42:44 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 34.50 seconds and fetched: rows=61540
2026-01-22 14:42:44 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-22 14:42:44 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-22 14:42:45 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-22 14:42:45 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-22 14:42:45 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-22 14:42:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-22 14:42:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.18 : 0 rows - Line (802- 895)
2026-01-22 14:42:47 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice processing completed. Records: 7998
2026-01-22 14:42:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getsweepsalespersrterminal data extraction...
2026-01-22 14:42:50 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getsweepsalespersrterminal data extraction completed. Records: 0
2026-01-22 14:42:50 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_sales_scandsr_loc processing...
2026-01-22 14:42:50 - Transformation - INFO - UBT_TEMP_SALES_SCANDSR_LOC COMPLETED : 0 rows - Line (964 - 995)
2026-01-22 14:42:50 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_sales_scandsr_loc processing completed. Records: 0
2026-01-22 14:42:50 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_salesfactorconfig data extraction...
2026-01-22 14:42:50 - Transformation - INFO - ubt_temp_salesfactorconfig: Retrieved 8 records.
2026-01-22 14:42:50 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_salesfactorconfig data extraction completed. Records: 8
2026-01-22 14:42:50 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice_2nd processing...
2026-01-22 14:42:50 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.1 COMPLETED : 9048 rows - Line (990 - 1001)
2026-01-22 14:42:50 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.2 COMPLETED : 3500 rows - Line (1003 - 1016)
2026-01-22 14:42:50 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.3 COMPLETED : 422 rows - Line (1022 - 1044)
2026-01-22 14:42:50 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.5 COMPLETED : 318 rows - Line (1077 - 1126)
2026-01-22 14:42:50 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.6 COMPLETED : 0 rows - Line (1132 - 1150)
2026-01-22 14:42:50 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.7 COMPLETED : 1762 rows - Line (1152 - 1161)
2026-01-22 14:42:50 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice_2nd processing completed. Records: 6360
2026-01-22 14:42:50 - Main_sp_ubt_getlocationinvoice - INFO - READY TO WRITE TO SNOWFLAKE WITH 6360 rows
2026-01-22 14:42:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-22 14:42:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-22 14:42:53 - Main_sp_ubt_getlocationinvoice - INFO - Writing data to Snowflake table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE...
2026-01-22 14:42:53 - write_pandas - INFO - Current context - Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC, Warehouse: SPPL_WH_DEV
2026-01-22 14:42:53 - write_pandas - INFO - Switched to Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC
2026-01-22 14:42:54 - write_pandas - INFO - Table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE exists. Clearing existing data...
2026-01-22 14:42:54 - write_pandas - INFO - Successfully deleted records for PROCDATE = '20251127'
2026-01-22 14:42:54 - write_pandas - INFO - Inserting new data into existing table...
2026-01-22 14:42:55 - write_pandas - INFO - Verification: 6360 rows found in SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-22 14:42:56 - write_pandas - INFO - Successfully written 6360 rows to SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-22 14:42:56 - write_pandas - INFO - Number of chunks: 1, Success: True
2026-01-22 14:42:56 - Main_sp_ubt_getlocationinvoice - INFO - ETL process completed successfully in 32.14 seconds.
