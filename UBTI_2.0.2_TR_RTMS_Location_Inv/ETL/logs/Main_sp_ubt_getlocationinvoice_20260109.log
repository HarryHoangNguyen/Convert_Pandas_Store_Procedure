2026-01-09 18:06:42 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:06:42 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:06:42 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 2025-11-27 00:00:00
2026-01-09 18:06:42 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 2025-11-27 00:00:00
2026-01-09 18:06:42 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:06:42 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:06:42 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:06:42 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:06:43 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:06:43 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:06:44 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:06:44 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:06:44 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:06:44 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:06:44 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:06:44 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:06:45 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:06:45 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:06:45 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:06:45 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:06:45 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:08:02 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:08:02 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:08:02 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 2025-11-27 00:00:00
2026-01-09 18:08:02 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 2025-11-27 00:00:00
2026-01-09 18:08:02 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:08:02 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:08:02 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:08:03 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:08:03 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:08:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:08:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:08:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:08:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:08:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:08:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:08:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:08:04 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:08:04 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:08:04 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:08:04 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:08:04 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:08:53 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:08:53 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:08:53 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 2025-11-27 00:00:00
2026-01-09 18:08:53 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 2025-11-27 00:00:00
2026-01-09 18:08:53 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:08:53 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:08:53 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:08:54 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:08:54 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:08:54 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:08:54 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:08:54 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:08:54 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:08:54 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:08:54 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:08:54 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:08:55 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:08:55 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:08:55 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:08:55 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:08:55 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:09:02 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 0
2026-01-09 18:09:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-09 18:09:02 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-09 18:09:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-09 18:09:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 7
2026-01-09 18:09:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-09 18:09:03 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-09 18:09:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-09 18:09:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-09 18:09:03 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-09 18:09:03 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-09 18:09:04 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-09 18:09:04 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-09 18:09:04 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-09 18:09:04 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-09 18:09:04 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-09 18:09:04 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-09 18:09:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:09:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:09:09 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-09 18:10:15 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:10:15 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:10:15 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 2025-11-27 00:00:00
2026-01-09 18:10:15 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 2025-11-27 00:00:00
2026-01-09 18:10:15 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:10:15 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:10:15 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:10:16 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:10:16 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:10:16 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:10:16 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:10:16 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:10:17 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:10:17 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:10:17 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:10:17 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:10:17 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:10:17 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:10:17 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:10:17 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:10:17 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 0
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 7
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-09 18:10:23 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-09 18:10:23 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-09 18:10:23 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-09 18:10:23 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-09 18:10:23 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-09 18:10:23 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-09 18:10:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:10:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:10:26 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-09 18:10:31 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-09 18:10:32 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-09 18:10:33 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:10:33 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:10:33 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-09 18:10:33 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-09 18:10:33 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-09 18:10:34 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-09 18:10:34 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-09 18:10:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:10:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:10:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-09 18:10:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-09 18:10:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-09 18:10:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-09 18:10:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-09 18:10:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-09 18:10:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-09 18:10:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-09 18:10:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-09 18:10:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-09 18:10:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:10:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-09 18:10:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:10:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-09 18:10:40 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-09 18:10:40 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-09 18:10:40 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-09 18:10:41 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-09 18:10:41 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-09 18:10:41 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-09 18:10:41 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-09 18:10:41 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-09 18:10:42 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:10:43 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:10:44 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:10:44 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:10:44 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:10:44 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 38.26 seconds and fetched: rows=61540
2026-01-09 18:10:44 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-09 18:10:44 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-09 18:10:45 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-09 18:10:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-09 18:10:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-09 18:10:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-09 18:10:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-09 18:10:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-09 18:10:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-09 18:10:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-09 18:10:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-09 18:10:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-09 18:10:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-09 18:10:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-09 18:10:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-09 18:10:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-09 18:10:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-09 18:10:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-09 18:10:47 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-09 18:10:48 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.18 : 0 rows - Line (802- 895)
2026-01-09 18:10:48 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice processing completed. Records: 7998
2026-01-09 18:10:48 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getsweepsalespersrterminal data extraction...
2026-01-09 18:11:45 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:11:45 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:11:45 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 2025-11-27 00:00:00
2026-01-09 18:11:45 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 2025-11-27 00:00:00
2026-01-09 18:11:45 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:11:45 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:11:45 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:11:46 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:11:46 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:11:46 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:11:46 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:11:46 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:11:47 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:11:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:11:47 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:11:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:11:47 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:11:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:11:47 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:11:47 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:11:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:11:51 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 0
2026-01-09 18:11:51 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-09 18:11:51 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-09 18:11:51 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-09 18:11:51 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 7
2026-01-09 18:11:51 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-09 18:11:51 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-09 18:11:51 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-09 18:11:51 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-09 18:11:51 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-09 18:11:51 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-09 18:11:52 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-09 18:11:52 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-09 18:11:52 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-09 18:11:52 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-09 18:11:52 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-09 18:11:52 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-09 18:11:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:11:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:11:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-09 18:11:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-09 18:11:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-09 18:11:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:11:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:11:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-09 18:11:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-09 18:11:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-09 18:11:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-09 18:11:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-09 18:11:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:11:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:11:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-09 18:12:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-09 18:12:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-09 18:12:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-09 18:12:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-09 18:12:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-09 18:12:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-09 18:12:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-09 18:12:02 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-09 18:12:02 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-09 18:12:02 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-09 18:12:02 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-09 18:12:02 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-09 18:12:02 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:12:03 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:12:03 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:12:03 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:12:04 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:12:04 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 30.46 seconds and fetched: rows=61540
2026-01-09 18:12:04 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-09 18:12:04 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-09 18:12:05 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-09 18:12:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-09 18:12:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-09 18:12:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-09 18:12:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-09 18:12:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-09 18:12:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-09 18:12:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-09 18:12:07 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.18 : 0 rows - Line (802- 895)
2026-01-09 18:12:07 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice processing completed. Records: 7998
2026-01-09 18:12:07 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getsweepsalespersrterminal data extraction...
2026-01-09 18:12:57 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:12:57 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:12:57 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 2025-11-27 00:00:00
2026-01-09 18:12:57 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 2025-11-27 00:00:00
2026-01-09 18:12:57 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:12:57 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:12:57 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:12:58 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:12:58 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:12:58 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:12:58 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:12:58 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:12:58 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:12:58 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:12:59 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:12:59 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:12:59 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:12:59 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:12:59 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:12:59 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:12:59 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:13:02 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 0
2026-01-09 18:13:02 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 7
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-09 18:13:03 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-09 18:13:03 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-09 18:13:03 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-09 18:13:03 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-09 18:13:03 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-09 18:13:03 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-09 18:13:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:13:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:13:05 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-09 18:13:09 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-09 18:13:10 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-09 18:13:10 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:13:10 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:13:10 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-09 18:13:10 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-09 18:13:10 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-09 18:13:10 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-09 18:13:10 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-09 18:13:11 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:13:11 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:13:11 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-09 18:13:11 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-09 18:13:11 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-09 18:13:11 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-09 18:13:12 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-09 18:13:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-09 18:13:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-09 18:13:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-09 18:13:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-09 18:13:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-09 18:13:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-09 18:13:13 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-09 18:13:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:13:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:13:14 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:13:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:13:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:13:15 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 30.95 seconds and fetched: rows=61540
2026-01-09 18:13:15 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-09 18:13:15 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-09 18:13:16 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-09 18:13:16 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-09 18:13:16 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-09 18:13:16 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-09 18:13:16 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-09 18:13:17 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-09 18:13:18 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.18 : 0 rows - Line (802- 895)
2026-01-09 18:13:18 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice processing completed. Records: 7998
2026-01-09 18:13:18 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getsweepsalespersrterminal data extraction...
2026-01-09 18:14:33 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:14:33 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:14:33 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 2025-11-27 00:00:00
2026-01-09 18:14:33 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 2025-11-27 00:00:00
2026-01-09 18:14:33 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:14:33 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:14:33 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:14:33 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:14:33 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:14:33 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:14:33 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:14:33 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:14:34 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:14:34 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:14:34 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:14:34 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:14:34 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:14:34 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:14:34 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:14:34 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:14:34 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:14:40 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 0
2026-01-09 18:14:40 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-09 18:14:40 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-09 18:14:40 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-09 18:14:40 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 7
2026-01-09 18:14:40 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-09 18:14:41 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-09 18:14:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-09 18:14:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-09 18:14:41 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-09 18:14:41 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-09 18:14:41 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-09 18:14:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-09 18:14:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-09 18:14:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-09 18:14:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-09 18:14:41 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-09 18:14:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:14:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:14:43 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-09 18:14:46 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-09 18:14:46 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-09 18:14:46 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:14:46 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-09 18:14:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:14:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-09 18:14:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-09 18:14:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-09 18:14:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:14:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:14:51 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:14:51 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:14:51 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:14:51 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 28.22 seconds and fetched: rows=61540
2026-01-09 18:14:51 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-09 18:14:51 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-09 18:14:52 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-09 18:14:52 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-09 18:14:52 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-09 18:14:52 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-09 18:14:52 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-09 18:14:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-09 18:14:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.18 : 0 rows - Line (802- 895)
2026-01-09 18:14:54 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice processing completed. Records: 7998
2026-01-09 18:14:54 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getsweepsalespersrterminal data extraction...
2026-01-09 18:14:59 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getsweepsalespersrterminal data extraction completed. Records: 0
2026-01-09 18:14:59 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_sales_scandsr_loc processing...
2026-01-09 18:14:59 - Transformation - INFO - UBT_TEMP_SALES_SCANDSR_LOC COMPLETED : 0 rows - Line (964 - 995)
2026-01-09 18:14:59 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_sales_scandsr_loc processing completed. Records: 0
2026-01-09 18:14:59 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_salesfactorconfig data extraction...
2026-01-09 18:15:00 - Transformation - INFO - ubt_temp_salesfactorconfig: Retrieved 8 records.
2026-01-09 18:15:00 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_salesfactorconfig data extraction completed. Records: 8
2026-01-09 18:15:00 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice_2nd processing...
2026-01-09 18:15:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.1 COMPLETED : 9048 rows - Line (990 - 1001)
2026-01-09 18:15:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.2 COMPLETED : 3500 rows - Line (1003 - 1016)
2026-01-09 18:15:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.3 COMPLETED : 422 rows - Line (1022 - 1044)
2026-01-09 18:15:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.5 COMPLETED : 318 rows - Line (1077 - 1126)
2026-01-09 18:15:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.6 COMPLETED : 0 rows - Line (1132 - 1150)
2026-01-09 18:15:00 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.7 COMPLETED : 1762 rows - Line (1152 - 1161)
2026-01-09 18:15:00 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice_2nd processing completed. Records: 6360
2026-01-09 18:15:00 - Main_sp_ubt_getlocationinvoice - INFO - READY TO WRITE TO SNOWFLAKE WITH 6360 rows
2026-01-09 18:15:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:15:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:15:03 - Main_sp_ubt_getlocationinvoice - INFO - Writing data to Snowflake table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE...
2026-01-09 18:15:03 - write_pandas - INFO - Current context - Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC, Warehouse: SPPL_WH_DEV
2026-01-09 18:15:03 - write_pandas - INFO - Switched to Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC
2026-01-09 18:15:04 - write_pandas - INFO - Table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE exists. Clearing existing data...
2026-01-09 18:15:04 - write_pandas - INFO - Successfully deleted records for PROCDATE = '2025-11-27 00:00:00'
2026-01-09 18:15:04 - write_pandas - INFO - Inserting new data into existing table...
2026-01-09 18:15:06 - write_pandas - INFO - Verification: 12720 rows found in SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-09 18:15:06 - write_pandas - INFO - Successfully written 6360 rows to SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-09 18:15:06 - write_pandas - INFO - Number of chunks: 1, Success: True
2026-01-09 18:15:06 - Main_sp_ubt_getlocationinvoice - INFO - ETL process completed successfully in 33.22 seconds.
2026-01-09 18:22:19 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:22:19 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:22:19 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 20251127
2026-01-09 18:22:19 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 20251127
2026-01-09 18:22:19 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:22:19 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:22:19 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:22:19 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:22:20 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:22:20 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:22:20 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:22:20 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:22:22 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:22:22 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:22:22 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:22:22 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:22:23 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:22:23 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:22:23 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:22:23 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:22:23 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 0
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 7
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-09 18:22:27 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-09 18:22:27 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-09 18:22:27 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-09 18:22:27 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-09 18:22:27 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-09 18:22:27 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-09 18:22:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:22:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:22:31 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-09 18:22:34 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-09 18:22:34 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-09 18:22:34 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:22:34 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:22:34 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-09 18:22:34 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-09 18:22:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-09 18:22:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-09 18:22:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-09 18:22:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:22:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:22:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-09 18:22:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-09 18:22:35 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-09 18:22:36 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:22:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-09 18:22:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-09 18:22:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-09 18:22:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-09 18:22:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-09 18:22:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-09 18:22:37 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-09 18:22:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-09 18:22:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-09 18:22:38 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:22:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:22:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:22:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:22:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:22:39 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 30.88 seconds and fetched: rows=61540
2026-01-09 18:22:40 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-09 18:22:40 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-09 18:22:41 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-09 18:22:41 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-09 18:22:41 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-09 18:22:41 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-09 18:22:41 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-09 18:22:41 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-09 18:22:42 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-09 18:22:44 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.18 : 0 rows - Line (802- 895)
2026-01-09 18:22:44 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice processing completed. Records: 7998
2026-01-09 18:22:44 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getsweepsalespersrterminal data extraction...
2026-01-09 18:22:46 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getsweepsalespersrterminal data extraction completed. Records: 0
2026-01-09 18:22:46 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_sales_scandsr_loc processing...
2026-01-09 18:22:46 - Transformation - INFO - UBT_TEMP_SALES_SCANDSR_LOC COMPLETED : 0 rows - Line (964 - 995)
2026-01-09 18:22:46 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_sales_scandsr_loc processing completed. Records: 0
2026-01-09 18:22:46 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_salesfactorconfig data extraction...
2026-01-09 18:22:46 - Transformation - INFO - ubt_temp_salesfactorconfig: Retrieved 8 records.
2026-01-09 18:22:46 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_salesfactorconfig data extraction completed. Records: 8
2026-01-09 18:22:46 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice_2nd processing...
2026-01-09 18:22:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.1 COMPLETED : 9048 rows - Line (990 - 1001)
2026-01-09 18:22:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.2 COMPLETED : 3500 rows - Line (1003 - 1016)
2026-01-09 18:22:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.3 COMPLETED : 422 rows - Line (1022 - 1044)
2026-01-09 18:22:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.5 COMPLETED : 318 rows - Line (1077 - 1126)
2026-01-09 18:22:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.6 COMPLETED : 0 rows - Line (1132 - 1150)
2026-01-09 18:22:46 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.7 COMPLETED : 1762 rows - Line (1152 - 1161)
2026-01-09 18:22:46 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice_2nd processing completed. Records: 6360
2026-01-09 18:22:46 - Main_sp_ubt_getlocationinvoice - INFO - READY TO WRITE TO SNOWFLAKE WITH 6360 rows
2026-01-09 18:22:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:22:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:22:50 - Main_sp_ubt_getlocationinvoice - INFO - Writing data to Snowflake table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE...
2026-01-09 18:22:50 - write_pandas - INFO - Current context - Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC, Warehouse: SPPL_WH_DEV
2026-01-09 18:22:50 - write_pandas - INFO - Switched to Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC
2026-01-09 18:22:51 - write_pandas - INFO - Table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE exists. Clearing existing data...
2026-01-09 18:22:51 - write_pandas - INFO - Successfully deleted records for PROCDATE = '20251127'
2026-01-09 18:22:51 - write_pandas - INFO - Inserting new data into existing table...
2026-01-09 18:22:53 - write_pandas - INFO - Verification: 19080 rows found in SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-09 18:22:53 - write_pandas - INFO - Successfully written 6360 rows to SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-09 18:22:53 - write_pandas - INFO - Number of chunks: 1, Success: True
2026-01-09 18:22:53 - Main_sp_ubt_getlocationinvoice - INFO - ETL process completed successfully in 34.49 seconds.
2026-01-09 18:23:36 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:23:36 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:23:36 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 20251127
2026-01-09 18:23:36 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 20251127
2026-01-09 18:23:36 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:23:36 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:23:36 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:23:37 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:23:37 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:23:37 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:23:37 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:23:37 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:23:37 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:23:37 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:23:38 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:23:38 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:23:38 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:23:38 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:23:38 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:23:38 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:23:38 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 0
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 7
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-09 18:23:41 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-09 18:23:41 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-09 18:23:41 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-09 18:23:41 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-09 18:23:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-09 18:23:41 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-09 18:23:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:23:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:23:44 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-09 18:23:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-09 18:23:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-09 18:23:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:23:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:23:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-09 18:23:48 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:23:49 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-09 18:23:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-09 18:23:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-09 18:23:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-09 18:23:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-09 18:23:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-09 18:23:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-09 18:23:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-09 18:23:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-09 18:23:51 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:23:51 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:23:52 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:23:52 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:23:52 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:23:52 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 27.42 seconds and fetched: rows=61540
2026-01-09 18:23:52 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-09 18:23:52 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-09 18:23:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-09 18:23:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-09 18:23:53 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-09 18:23:54 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-09 18:23:56 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.18 : 0 rows - Line (802- 895)
2026-01-09 18:23:56 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice processing completed. Records: 7998
2026-01-09 18:23:56 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getsweepsalespersrterminal data extraction...
2026-01-09 18:23:58 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getsweepsalespersrterminal data extraction completed. Records: 0
2026-01-09 18:23:58 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_sales_scandsr_loc processing...
2026-01-09 18:23:58 - Transformation - INFO - UBT_TEMP_SALES_SCANDSR_LOC COMPLETED : 0 rows - Line (964 - 995)
2026-01-09 18:23:58 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_sales_scandsr_loc processing completed. Records: 0
2026-01-09 18:23:58 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_salesfactorconfig data extraction...
2026-01-09 18:23:58 - Transformation - INFO - ubt_temp_salesfactorconfig: Retrieved 8 records.
2026-01-09 18:23:58 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_salesfactorconfig data extraction completed. Records: 8
2026-01-09 18:23:58 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice_2nd processing...
2026-01-09 18:23:58 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.1 COMPLETED : 9048 rows - Line (990 - 1001)
2026-01-09 18:23:58 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.2 COMPLETED : 3500 rows - Line (1003 - 1016)
2026-01-09 18:23:58 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.3 COMPLETED : 422 rows - Line (1022 - 1044)
2026-01-09 18:23:59 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.5 COMPLETED : 318 rows - Line (1077 - 1126)
2026-01-09 18:23:59 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.6 COMPLETED : 0 rows - Line (1132 - 1150)
2026-01-09 18:23:59 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.7 COMPLETED : 1762 rows - Line (1152 - 1161)
2026-01-09 18:23:59 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice_2nd processing completed. Records: 6360
2026-01-09 18:23:59 - Main_sp_ubt_getlocationinvoice - INFO - READY TO WRITE TO SNOWFLAKE WITH 6360 rows
2026-01-09 18:23:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:23:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:24:01 - Main_sp_ubt_getlocationinvoice - INFO - Writing data to Snowflake table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE...
2026-01-09 18:24:01 - write_pandas - INFO - Current context - Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC, Warehouse: SPPL_WH_DEV
2026-01-09 18:24:01 - write_pandas - INFO - Switched to Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC
2026-01-09 18:24:02 - write_pandas - INFO - Table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE exists. Clearing existing data...
2026-01-09 18:24:05 - write_pandas - INFO - Successfully deleted records for PROCDATE = '20251127'
2026-01-09 18:24:05 - write_pandas - INFO - Inserting new data into existing table...
2026-01-09 18:24:07 - write_pandas - INFO - Verification: 6360 rows found in SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-09 18:24:07 - write_pandas - INFO - Successfully written 6360 rows to SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-09 18:24:07 - write_pandas - INFO - Number of chunks: 1, Success: True
2026-01-09 18:24:07 - Main_sp_ubt_getlocationinvoice - INFO - ETL process completed successfully in 30.89 seconds.
2026-01-09 18:30:39 - Main_sp_ubt_getlocationinvoice - INFO - Logging started. Log file: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL/logs/Main_sp_ubt_getlocationinvoice_20260109.log
2026-01-09 18:30:39 - Main_sp_ubt_getlocationinvoice - INFO - Current working directory: /home/minhhoang/pyspark/Python-Project/UBTI_2.0.2_TR_RTMS_Location_Inv/ETL
2026-01-09 18:30:39 - Main_sp_ubt_getlocationinvoice - INFO - Running in LOCAL mode. procdate: 20251127
2026-01-09 18:30:39 - Main_sp_ubt_getlocationinvoice - INFO - Process date: 20251127
2026-01-09 18:30:39 - declare_Variables - INFO - Starting to declare variables... (From Line 6)
2026-01-09 18:30:39 - declare_Variables - INFO - Converted vbusinessdate to date object and calculated vinput_date & vactual_date. (Line 26-29)
2026-01-09 18:30:39 - declare_Variables - INFO - Completed calculating financial week boundaries. (Line 32-40)
2026-01-09 18:30:39 - declare_Variables - INFO - Completed calling sp_ubt_getcommonubtdates stored procedure & assigning variables. (Line 42-54)
2026-01-09 18:30:39 - declare_Variables - INFO - Declared vinvoiceperiodid variable VALUE 2946. (Line 56-48)
2026-01-09 18:30:39 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_TERMINAL data extraction...
2026-01-09 18:30:40 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_TERMINAL data extraction completed. Records: 1025
2026-01-09 18:30:40 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_LOCATION data extraction...
2026-01-09 18:30:41 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_LOCATION data extraction completed. Records: 351
2026-01-09 18:30:41 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_PRODUCT data extraction...
2026-01-09 18:30:42 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_PRODUCT data extraction completed. Records: 12
2026-01-09 18:30:42 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_CHAIN data extraction...
2026-01-09 18:30:42 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_CHAIN data extraction completed. Records: 30
2026-01-09 18:30:42 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_cancelledbeticket data extraction...
2026-01-09 18:30:42 - Transformation - INFO - ubt_temp_cancelledbeticket: Retrieved 0 records.
2026-01-09 18:30:42 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_cancelledbeticket data extraction completed. Records: 0
2026-01-09 18:30:42 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getamounttransaction processing...
2026-01-09 18:30:46 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getamounttransaction completed. Records: 0
2026-01-09 18:30:46 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_RESUTLCASHLESSLOCATION data extraction...
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_RESUTLCASHLESSLOCATION data extraction completed. Records: 0
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_itotolocation data extraction...
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_itotolocation data extraction completed. Records: 7
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_GroupToToLocation data extraction...
2026-01-09 18:30:47 - Transformation - INFO - UBT_TEMP_GROUPTOLOCATION COMPLETED : 0 rows - Line (223 - 231)
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_GroupToToLocation data extraction completed. Records: 0
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SalesgroupTotoLocation data extraction...
2026-01-09 18:30:47 - Transformation - INFO - UBT_TEMP_FIN COMPLETED : 0 rows - Line (278 - 290)
2026-01-09 18:30:47 - Transformation - INFO - UBT_TEMP_CAN COMPLETED : 0 rows - Line (294 - 299)
2026-01-09 18:30:47 - Transformation - INFO - UBT_TEMP_SALESGROUPTOLOCATION COMPLETED : 0 rows - Line (258 - 311)
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SalesgroupTotoLocation data extraction completed. Records: 0
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting UBT_TEMP_SALESTOTOLOCATION data extraction...
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - UBT_TEMP_SALESTOTOLOCATION data extraction completed. Records: 0
2026-01-09 18:30:47 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_gettransamountdetails data extraction...
2026-01-09 18:30:47 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Initializing SP_UBT_GETTRANSAMOUNTDETAILS with input range from=20251124, to=20251127
2026-01-09 18:30:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:30:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:30:50 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Calling SP_UBT_GETCOMMONUBTDATES ...
2026-01-09 18:30:53 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Processing df_trans_amt ...
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 SAL' completed successfully, rows=1018
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 SAL' completed successfully, rows=1018
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL' completed successfully, rows=1018
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 SAL - added' completed successfully, rows=1018
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 SAL' completed successfully, rows=1018
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HORSE RACING ProdID=1 COL' completed successfully, rows=1024
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] '4D ProdID=2 COL' completed successfully, rows=1025
2026-01-09 18:30:54 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:30:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'TOTO MATCH ProdID=3 COL' completed successfully, rows=1024
2026-01-09 18:30:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SWEEP ProdID=4 COL PB06 PB03' completed successfully, rows=1025
2026-01-09 18:30:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'SPORTS ProdID=5,6 COL' completed successfully, rows=1025
2026-01-09 18:30:55 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PAY' completed successfully, rows=0
2026-01-09 18:30:57 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 PAY LOSING BET REBATE-HORSE RACING' completed successfully, rows=1017
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=1 CANCELLED' completed successfully, rows=6150
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'HorseRacing PRODID=2,3 CANCELLED' completed successfully, rows=3075
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SWEEP PRODID=4 CANCELLED' completed successfully, rows=1025
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'CANCELLED BETTICKETS SPORTS PRODID=5,6 CANCELLED' completed successfully, rows=1025
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'Payment Type 'NC','NN'' completed successfully, rows=1025
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ' Pay Type 'NCC','NFP'' completed successfully, rows=1025
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PaynowQR 'PNQR'' completed successfully, rows=1025
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNRIC'' completed successfully, rows=1025
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'PayNow Transaction Fee 'PNQR'' completed successfully, rows=1025
2026-01-09 18:30:58 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL OFFLine ORDERS' completed successfully, rows=1025
2026-01-09 18:30:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'RFD Offlines ORDERS' completed successfully, rows=1025
2026-01-09 18:30:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'COL GATE ADMISSION' completed successfully, rows=1025
2026-01-09 18:30:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - FUN' completed successfully, rows=1024
2026-01-09 18:30:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'FUNDING AND RECOVERY - REC' completed successfully, rows=1024
2026-01-09 18:30:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - FUN' completed successfully, rows=1024
2026-01-09 18:30:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] 'ONLINE ADJUSTMENT - REC' completed successfully, rows=1024
2026-01-09 18:30:59 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] Date conversion completed
2026-01-09 18:31:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] df_temp_gst_sal update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:31:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:31:00 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_can_tktcount update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:31:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_toto_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:31:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] ubt_temp_totofo_sal_count update completed in ubt_temp_trans_amt, rows=67589
2026-01-09 18:31:01 - sp_ubt_gettransamountdetails - INFO - [SP_GETTRANSAMOUNTDETAILS] completed successfully in 31.88 seconds and fetched: rows=61540
2026-01-09 18:31:01 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_gettransamountdetails data extraction completed. Records: 42973
2026-01-09 18:31:01 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice processing...
2026-01-09 18:31:02 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.1 : 0 rows - Line (423 - 437)
2026-01-09 18:31:02 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.2 : 318 rows - Line (441 - 455)
2026-01-09 18:31:02 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.3 : 3816 rows - Line (464 - 480)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.4 : 0 rows - Line (489 - 503)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.5 : 318 rows - Line (505 - 519)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.6 : 3498 rows - Line (526 - 543)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.7 : 0 rows - Line (548 - 583)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.8 : 0 rows - Line (587 - 598)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.9 : 0 rows - Line (605 - 616)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.10 : 24 rows - Line (620 - 644)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.11 : 0 rows - Line (649 - 665)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.12 : 0 rows - Line (670 - 684)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.13 : 0 rows - Line (691 - 705)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.14 : 0 rows - Line (712 - 728)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.15 : 12 rows - Line (734 - 755)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.16 : 12 rows - Line (761 - 783)
2026-01-09 18:31:03 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.17 : 0 rows - Line (789 - 811)
2026-01-09 18:31:04 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE COMPLETED 1.18 : 0 rows - Line (802- 895)
2026-01-09 18:31:04 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice processing completed. Records: 7998
2026-01-09 18:31:04 - Main_sp_ubt_getlocationinvoice - INFO - Starting sp_ubt_getsweepsalespersrterminal data extraction...
2026-01-09 18:31:06 - Main_sp_ubt_getlocationinvoice - INFO - sp_ubt_getsweepsalespersrterminal data extraction completed. Records: 0
2026-01-09 18:31:06 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_sales_scandsr_loc processing...
2026-01-09 18:31:06 - Transformation - INFO - UBT_TEMP_SALES_SCANDSR_LOC COMPLETED : 0 rows - Line (964 - 995)
2026-01-09 18:31:06 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_sales_scandsr_loc processing completed. Records: 0
2026-01-09 18:31:06 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_salesfactorconfig data extraction...
2026-01-09 18:31:06 - Transformation - INFO - ubt_temp_salesfactorconfig: Retrieved 8 records.
2026-01-09 18:31:06 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_salesfactorconfig data extraction completed. Records: 8
2026-01-09 18:31:06 - Main_sp_ubt_getlocationinvoice - INFO - Starting ubt_temp_datalocationinvoice_2nd processing...
2026-01-09 18:31:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.1 COMPLETED : 9048 rows - Line (990 - 1001)
2026-01-09 18:31:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.2 COMPLETED : 3500 rows - Line (1003 - 1016)
2026-01-09 18:31:06 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.3 COMPLETED : 422 rows - Line (1022 - 1044)
2026-01-09 18:31:07 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.5 COMPLETED : 318 rows - Line (1077 - 1126)
2026-01-09 18:31:07 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.6 COMPLETED : 0 rows - Line (1132 - 1150)
2026-01-09 18:31:07 - Transformation - INFO - UBT_TEMP_DATALOCATIONINVOICE_2ND 1.7 COMPLETED : 1762 rows - Line (1152 - 1161)
2026-01-09 18:31:07 - Main_sp_ubt_getlocationinvoice - INFO - ubt_temp_datalocationinvoice_2nd processing completed. Records: 6360
2026-01-09 18:31:07 - Main_sp_ubt_getlocationinvoice - INFO - READY TO WRITE TO SNOWFLAKE WITH 6360 rows
2026-01-09 18:31:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-09 18:31:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2026-01-09 18:31:09 - Main_sp_ubt_getlocationinvoice - INFO - Writing data to Snowflake table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE...
2026-01-09 18:31:09 - write_pandas - INFO - Current context - Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC, Warehouse: SPPL_WH_DEV
2026-01-09 18:31:09 - write_pandas - INFO - Switched to Database: SPPL_DEV_DWH, Schema: SPPL_PUBLIC
2026-01-09 18:31:11 - write_pandas - INFO - Table SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE exists. Clearing existing data...
2026-01-09 18:31:11 - write_pandas - INFO - Successfully deleted records for PROCDATE = '20251127'
2026-01-09 18:31:11 - write_pandas - INFO - Inserting new data into existing table...
2026-01-09 18:31:13 - write_pandas - INFO - Verification: 6360 rows found in SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-09 18:31:13 - write_pandas - INFO - Successfully written 6360 rows to SPPL_DEV_DWH.SPPL_PUBLIC.SP_UBT_GETLOCATIONINVOICE
2026-01-09 18:31:13 - write_pandas - INFO - Number of chunks: 1, Success: True
2026-01-09 18:31:13 - Main_sp_ubt_getlocationinvoice - INFO - ETL process completed successfully in 33.95 seconds.
